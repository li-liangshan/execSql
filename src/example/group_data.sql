SELECT `org_id`, `qc_config_id`, COUNT(`check_item_id`) AS `count` FROM `qc_check_item_config` GROUP BY `org_id`, `qc_config_id`;

SELECT `qc_check_item`.`org_id` AS `org_id`, COUNT(`qc_check_item`.`id`) AS `check_item_count`,
`organization`.`name` AS `name` FROM `qc_check_item`
JOIN `user`.`organization` ON  `qc_check_item`.`org_id` = `organization`.`id` GROUP BY `org_id`, `name`;

SELECT `org_id`, AVG(`count`) as `avg_count`, MAX(`count`), MIN(`count`) FROM (
	SELECT `org_id`, `qc_config_id`, COUNT(check_item_id) AS `count` FROM `qc_check_item_config` GROUP BY `org_id`, `qc_config_id`
) AS A GROUP BY `org_id`;



SELECT `B`.`org_id`, `C`.`name`,`C`.`code`, `C`.`check_item_count` , `B`.`avg_count`, `B`.`max_count`, `B`.`min_count`
FROM (SELECT `org_id` , AVG(`count`) as `avg_count`, MAX(`count`) as `max_count`, MIN(`count`) as `min_count`
FROM (
SELECT `org_id`, `qc_config_id`, COUNT(check_item_id) AS `count`
FROM `qc_check_item_config` GROUP BY `org_id`, `qc_config_id`
) AS A GROUP BY `org_id`) AS B JOIN (
SELECT `qc_check_item`.`org_id` AS `org_id`, COUNT(`qc_check_item`.`id`) AS `check_item_count`,
`organization`.`name` AS `name`, `organization`.`code` AS `code`
FROM `qc_check_item` JOIN `user`.`organization` ON  `qc_check_item`.`org_id` = `organization`.`id`
GROUP BY `org_id`, `name`
) AS C ON `B`.`org_id` = `C`.`org_id`;

---
SELECT `C`.`org_id`, `C`.`name`,`C`.`code`, `C`.`check_item_count` , `B`.`avg_count`, `B`.`max_count`, `B`.`min_count`
FROM (
SELECT `organization`.`id` AS `org_id`, COUNT(`qc_check_item`.`id`) AS `check_item_count`, `organization`.`name` AS `name`, `organization`.`code` AS `code` FROM `qc_check_item` RIGHT JOIN `user`.`organization` ON  `qc_check_item`.`org_id` = `organization`.`id` GROUP BY `org_id`, `name`, `code`
) AS C LEFT JOIN (
SELECT `org_id` , AVG(`count`) as `avg_count`, MAX(`count`) as `max_count`, MIN(`count`) as `min_count` FROM (SELECT `org_id`, `qc_config_id`, COUNT(check_item_id) AS `count` FROM `qc_check_item_config` GROUP BY `org_id`, `qc_config_id`) AS A GROUP BY `org_id`
) AS B ON `B`.`org_id` = `C`.`org_id` ORDER BY `C`.`org_id`;


CREATE TABLE `organization_qc` (
  `org_id` bigint(20) NOT NULL,
  `name` char(64) NOT NULL,
  `code` char(10) NOT NULL,
  `check_item_count` int(11) DEFAULT NULL,
  `avg_count` decimal(20,6) DEFAULT NULL,
  `max_count` decimal(20,6) DEFAULT NULL,
  `min_count` decimal(20,6) DEFAULT NULL,
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`org_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工厂质检使用数据';


INSERT INTO `organization_qc` (`org_id`, `name`, `code`, `check_item_count`, `avg_count`, `max_count`, `min_count`)
VALUES
	(1, '黑湖组装厂', '100001', 72, 1.4170, 9, 1),
	(2, '黑湖测试1', '100002', 82, 2.6968, 6, 1),
	(3, '黑湖测试2', '100003', 0, NULL, NULL, NULL),
	(4, '黑湖测试3', '100004', 30, 1.2121, 2, 1),
	(5, 'c067de95-31b9-4704-8d78-86f1465f6197', '100005', 17, 1.2222, 3, 1),
	(6, 'CS-DEMO-紫', '120006', 38, 2.1092, 5, 1),
	(7, 'bc6c9db6-4455-4f24-abcb-fb314555cd5e', '100007', 5, 1.0000, 1, 1),
	(8, '8c070cf1-8a3d-400d-a096-4649cd6767b1', '100008', 92, 1.0439, 7, 1),
	(9, '56b38f38-7137-4086-b771-2129d026ee3a', '100009', 13, 1.0427, 6, 1),
	(10, 'f84a003a-e59e-4f99-a4a9-a2f3a4748fe7', '100010', 9, 1.0000, 1, 1),
	(12, '4fb0d3be-3896-4946-8e37-3ebfde997704', '100012', 8, 1.0000, 1, 1),
	(13, 'CS-DEMO-屈2', '100013', 51, 3.2381, 8, 1),
	(14, 'ec48fe2f-3ad7-4ad6-8673-31ec6ee9c65f', '100014', 0, NULL, NULL, NULL),
	(15, '5e2ccc28-8166-409e-99d5-04ba7f05d4da', '100015', 3, 1.0000, 1, 1),
	(16, 'CS-DEMO-唐', '120016', 71, 3.7500, 10, 1),
	(17, '销售DEMO-顾', '110017', 4, 1.0000, 1, 1),
	(18, '714a3b47-f324-4a5c-9d46-9831f992e651', '100018', 17, 1.1875, 4, 1),
	(19, '黑湖测试工厂', '100019', 73, 1.0078, 2, 1),
	(20, '2279f521-72eb-48c9-ae6c-3d92a8ca75d0', '100020', 3, NULL, NULL, NULL),
	(21, 'TMS DEMO', '100021', 91, 1.8750, 6, 1),
	(22, 'ddce9e54-bdb2-4830-9b8c-f960a0cd7ae4', '100022', 44, 2.0000, 9, 1),
	(23, '销售DEMO-刘总', '100023', 64, 1.8125, 4, 1),
	(24, '销售DEMO-王', '110024', 7, 2.4706, 4, 1),
	(25, 'df731733-0b99-4c1a-a41a-d974464089a7', '100025', 8, 3.6000, 5, 1),
	(26, 'bc721ace-c9c3-49b8-b407-dd33081c8fb2', '100026', 24, 1.3488, 3, 1),
	(27, '08011935-66f4-4f1c-a16c-7ad17f63ad9a', '100027', 31, 5.2857, 7, 2),
	(28, '诺雷淮安工厂\n', '600028', 6, 3.6667, 5, 2),
	(29, '开能Canature测试账号', '120029', 0, NULL, NULL, NULL),
	(30, '开能Canature', '700030', 285, 7.8312, 37, 1),
	(31, '冠特', '600031', 1, NULL, NULL, NULL),
	(32, '05265f73-c523-4dbe-9919-2935d236bc1a', '100032', 0, NULL, NULL, NULL),
	(33, '图峰', '600033', 3, 2.2500, 3, 1),
	(34, '销售DEMO-杨', '100034', 23, 2.5161, 4, 1),
	(35, '索尔维工厂', '600035', 0, NULL, NULL, NULL),
	(36, '销售DEMO-陈', '110036', 3, NULL, NULL, NULL),
	(37, 'CS-DEMO-屈', '110037', 3, 1.2857, 2, 1),
	(38, 'DEMO环境', '100038', 4, 2.3333, 3, 1),
	(39, '4093cf6c-c0a2-42a3-8c80-c945c2e4c7ac', '100039', 8, 1.4000, 3, 1),
	(41, 'bceea618-24d1-471d-9b86-d0972571a86b', '100041', 0, NULL, NULL, NULL),
	(47, '销售DEMO-章', '100047', 2, 1.0000, 1, 1),
	(48, '59897742-8d91-4a9e-bec4-918bbc70c15e', '100048', 0, NULL, NULL, NULL),
	(49, 'c54e3041-6062-4a1f-9b3a-ef3764d28926', '100049', 2, NULL, NULL, NULL),
	(50, 'ad6df968-af09-4309-a3a2-bc896afde2db', '100050', 0, NULL, NULL, NULL),
	(51, 'c227a489-b62d-4ad3-b65a-1cdf5740169f', '100051', 1, NULL, NULL, NULL),
	(52, 'e5d8c965-2b1e-4a17-a130-f383652d72aa', '100052', 0, NULL, NULL, NULL),
	(53, '停用-海泰科特测试', '120053', 8, 1.1667, 3, 1),
	(54, '测试工厂54', '100054', 23, 3.7273, 13, 2),
	(55, '测试工厂55', '100055', 2, 2.0000, 2, 2),
	(56, '测试工厂56', '100056', 2, 2.0000, 2, 2),
	(57, '测试工厂57', '100057', 3, NULL, NULL, NULL),
	(58, '测试工厂58', '100058', 2, 2.0000, 2, 2),
	(59, 'a2233dde-6ed3-44c2-9133-cdff4a6e1dbb', '100059', 5, 1.1667, 2, 1),
	(60, 'CSDEMO-培训用', '100060', 14, 2.2143, 6, 1),
	(61, '停用', '100061', 0, NULL, NULL, NULL),
	(62, 'CS-DEMO-科', '100062', 57, 4.4400, 6, 1),
	(63, '销售DEMO-王2', '110063', 12, 1.6667, 3, 1),
	(64, 'CS-DEMO-科2', '100064', 5, NULL, NULL, NULL),
	(65, '成衣厂', '100065', 1, NULL, NULL, NULL),
	(66, 'CS-DEMO-包装工厂', '120066', 5, 5.0000, 5, 5),
	(67, '海泰科特', '100067', 8, 3.4545, 4, 1),
	(68, '销售DEMO-朱', '110068', 3, 2.3333, 3, 1),
	(69, '64ccb1e3-1cd5-492c-9fcb-5072d4427ba7', '100069', 0, NULL, NULL, NULL),
	(70, 'f2c9681f-9cad-4380-bafc-9ff2f65f9be8', '100070', 7, 2.0000, 3, 1),
	(71, '84658afc-0bd1-484f-91a5-a537d8944139', '100071', 0, NULL, NULL, NULL),
	(72, 'c84eeb36-f83a-4ece-aaa5-da85aa3a2894', '100072', 0, NULL, NULL, NULL),
	(73, 'd28e0bf7-59dd-4c0e-831f-221f55764ce5', '100073', 3, 1.0000, 1, 1),
	(74, '订制家具厂', '600074', 2, 1.7500, 2, 1),
	(75, 'fe166287-b8b4-49dc-b203-c2fd89bb0abb', '100075', 0, NULL, NULL, NULL),
	(76, 'c8148275-e41c-4499-9110-68f4dfa4d323', '100076', 0, NULL, NULL, NULL),
	(77, '2018/06/08/01', '100077', 3, 1.1707, 3, 1),
	(78, '永强测试工厂001', '100078', 0, NULL, NULL, NULL),
	(79, '1234', '100079', 0, NULL, NULL, NULL),
	(80, '061101', '100080', 0, NULL, NULL, NULL),
	(81, '销售DEMO-刘', '120081', 5, 1.0000, 1, 1),
	(82, '061301', '100082', 1, 1.0000, 1, 1),
	(83, 'TMSTEST', '120083', 0, NULL, NULL, NULL),
	(84, 'TMSDEMO', '120084', 5, 3.8750, 5, 2),
	(85, '销售DEMO-李', '110085', 0, NULL, NULL, NULL),
	(86, '销售DEMO-伯', '100086', 0, NULL, NULL, NULL),
	(87, 'WR-DEMO', '300087', 0, NULL, NULL, NULL),
	(88, 'ZKYC-DEMO', '300088', 2, 1.0000, 1, 1),
	(89, 'MKT-DEMO', '100089', 1, 1.0000, 1, 1),
	(90, '永强测试工厂', '100090', 0, NULL, NULL, NULL),
	(91, 'glq-主管派发', '100091', 0, NULL, NULL, NULL),
	(92, 'glq-主管派发工厂1', '100092', 0, NULL, NULL, NULL),
	(93, 'glq-工人弱管控', '100093', 0, NULL, NULL, NULL),
	(94, '测试-塑料地板', '120094', 17, 4.0000, 6, 2),
	(95, 'HI-TECH', '700095', 18, 2.5325, 7, 1),
	(96, 'DEMO-纺织工厂', '120096', 0, NULL, NULL, NULL),
	(97, '江苏标久科技', '600097', 9, 1.0000, 1, 1),
	(98, '设备工厂', '100098', 0, NULL, NULL, NULL),
	(99, '东宏管业-正式', '600099', 171, 24.6085, 41, 4),
	(100, 'CS-DEMO-屈3', '100100', 2, 1.0000, 1, 1),
	(101, '韶关美妥维志化工', '100101', 0, NULL, NULL, NULL),
	(102, '设备试用账号', '100102', 0, NULL, NULL, NULL),
	(103, '广东中强精英电子', '100103', 0, NULL, NULL, NULL),
	(104, '重庆宏锐汽车零部件', '100104', 0, NULL, NULL, NULL),
	(105, '沈阳燃气有限公司', '100105', 0, NULL, NULL, NULL),
	(106, '沈阳燃气有限公司试用', '100106', 0, NULL, NULL, NULL),
	(107, '威孚高科', '100107', 0, NULL, NULL, NULL),
	(108, '合肥金星机电科技发展有限公司', '100108', 0, NULL, NULL, NULL),
	(109, '浙江省烟草公司衢州市公司', '100109', 0, NULL, NULL, NULL),
	(110, '日丰管材山水工厂', '600110', 0, NULL, NULL, NULL),
	(111, '百色市金海誉科技有限公司', '100111', 0, NULL, NULL, NULL),
	(112, 'CS-DEMO-PVC地板', '120112', 68, 7.0727, 12, 1),
	(113, 'DEMO-MENGYA', '120113', 20, 1.5417, 7, 1),
	(114, '销售DEMO-赖', '120114', 4, 1.4444, 2, 1),
	(115, 'DEMO-MAJIAQIANG', '100115', 0, NULL, NULL, NULL),
	(116, '营口天成消防设备有限公司', '100116', 0, NULL, NULL, NULL),
	(117, '江苏世纪中元机电设备工程有限公司', '100117', 0, NULL, NULL, NULL),
	(118, '北京铁轨首钢轨道技术股份有限公司', '100118', 0, NULL, NULL, NULL),
	(119, '山东创索智能科技有限公司', '100119', 0, NULL, NULL, NULL),
	(120, 'CS-DEMO-管业', '110120', 3, 3.0000, 3, 3),
	(121, 'DEMO美时达制冷', '120121', 3, 1.0000, 1, 1),
	(122, '上海外高桥造船有限公司', '100122', 0, NULL, NULL, NULL),
	(123, '潍柴动力股份有限公司', '100123', 0, NULL, NULL, NULL),
	(124, '小测1', '100124', 0, NULL, NULL, NULL),
	(125, '临清德运环保能源有限公司', '100125', 0, NULL, NULL, NULL),
	(126, '一汽解放汽车有限公司无锡柴油机厂', '100126', 0, NULL, NULL, NULL),
	(127, '爱丽地板试运行', '900127', 549, 11.4405, 31, 2),
	(128, '上汽通用东岳汽车有限公司', '100128', 0, NULL, NULL, NULL),
	(129, '广州市南亚电梯工程有限公司', '100129', 0, NULL, NULL, NULL),
	(130, '廖煜客户demo', '100130', 0, NULL, NULL, NULL),
	(131, '六安中财管道科技有限公司', '100131', 0, NULL, NULL, NULL),
	(132, 'CS-DEMO-邱', '100132', 18, 3.7168, 9, 1),
	(133, '科尔帕默', '000133', 205, 9.7414, 20, 3),
	(134, '黑湖工厂-工博会', '100134', 13, 2.6087, 4, 1),
	(135, '江苏新韩通船舶重工有限公司', '100135', 0, NULL, NULL, NULL),
	(136, '美克美家家具连锁有限公司', '100136', 0, NULL, NULL, NULL),
	(137, '惠州固德尔', '600137', 20, 5.0000, 9, 4),
	(138, '广东联升传导技术有限公司', '100138', 0, NULL, NULL, NULL),
	(139, '东莞朝隆机械有限公司', '100139', 0, NULL, NULL, NULL),
	(140, '青岛海信电器公司', '100140', 0, NULL, NULL, NULL),
	(141, '潍坊凯信机械有限公司', '100141', 0, NULL, NULL, NULL),
	(142, '唐维DEMO2', '120142', 0, NULL, NULL, NULL),
	(143, '江阴市虎踞冶金设备有限公司', '100143', 0, NULL, NULL, NULL),
	(144, '中科云创测试', '100144', 0, NULL, NULL, NULL),
	(145, '三菱重工海尔（青岛）空调机有限公司', '100145', 0, NULL, NULL, NULL),
	(146, '鲁花集团', '100146', 0, NULL, NULL, NULL),
	(147, '丹阳大亚铝箔', '100147', 0, NULL, NULL, NULL),
	(148, '泽鸿（广州）电子科技有限公司', '100148', 0, NULL, NULL, NULL),
	(149, '销售DEMO-郑', '100149', 16, 2.2333, 3, 1),
	(150, '紫薇测试1', '100150', 0, NULL, NULL, NULL),
	(151, '江苏扬子鑫福造船有限公司', '100151', 0, NULL, NULL, NULL),
	(152, '成都英诺思科技', '100152', 5, 3.4286, 5, 2),
	(153, '南库', '100153', 6, 4.0588, 5, 1),
	(154, '上海汇伦', '100154', 0, NULL, NULL, NULL),
	(155, '上海大众动力总成有限公司', '100155', 0, NULL, NULL, NULL),
	(156, '江西省木林森光电科技有限公司', '100156', 0, NULL, NULL, NULL),
	(157, 'CS-DEMO-三九', '100157', 134, 12.3376, 30, 1),
	(158, '百威哈尔滨', '100158', 13, 13.0000, 13, 13),
	(159, '紫薇的小厂1', '100159', 2, 2.0000, 2, 2),
	(160, '销售DEMO-1', '100160', 0, NULL, NULL, NULL),
	(161, 'CS-DEMO-梁', '100161', 17, 3.5231, 5, 1),
	(162, 'CS-DEMO-Liulf', '100162', 0, NULL, NULL, NULL),
	(163, 'CS-DEMO-红外线仪器', '120163', 10, 5.0000, 5, 5),
	(164, '演示账号', '100164', 0, NULL, NULL, NULL),
	(165, 'TEST-CXZ-1', '100165', 0, NULL, NULL, NULL),
	(166, '黑湖科技-CK3', '100166', 0, NULL, NULL, NULL),
	(167, 'TEST-SKY', '100167', 8, 2.9333, 4, 2),
	(168, '瀚云科技', '100168', 3, 2.0000, 2, 2),
	(169, '德力高demo', '100169', 1, 1.0000, 1, 1),
	(170, '沃元机械', '700170', 25, 4.9055, 12, 1),
	(171, 'TETS-SKY-2', '100171', 6, 6.0000, 6, 6),
	(172, '源通帽业', '100172', 1, 1.0000, 1, 1),
	(173, '树成demo', '100173', 17, 7.6667, 11, 1),
	(174, '天津美腾科技有限公司', '100174', 0, NULL, NULL, NULL),
	(175, '高李琴测试登陆工厂', '110901', 0, NULL, NULL, NULL),
	(176, '绿湖工厂', '123456', 0, NULL, NULL, NULL),
	(177, '日欣汽配', '600106', 46, 2.2563, 27, 1),
	(178, '青岛金环汽配制造有限公司（空）', 'xxxxxx', 0, NULL, NULL, NULL),
	(180, '青岛金环汽配制造有限公司', 'HU1000', 0, NULL, NULL, NULL),
	(181, 'TETS-SKY-3', '000002', 7, 5.6667, 7, 5),
	(182, '知数科技', 'zhishu', 0, NULL, NULL, NULL),
	(183, '恒达齿轮', '600122', 120, 5.0238, 13, 1),
	(184, '销售DEMO-贺', '110055', 3, 1.0000, 1, 1),
	(185, '知数科技', '300002', 0, NULL, NULL, NULL),
	(186, '明芝测试', '112400', 5, 1.0000, 1, 1),
	(187, '鸿榕工艺品', '601127', 4, 1.6176, 3, 1),
	(189, '锐力斯', '600123', 102, 26.3172, 27, 26),
	(190, 'CS-DEMO-Liulf2', '181205', 10, 10.0000, 10, 10),
	(197, '科尔帕默正式环境', '700333', 0, NULL, NULL, NULL),
	(198, '销售演示-烽', '118787', 1, NULL, NULL, NULL),
	(199, '液压管车间演示', '126060', 0, NULL, NULL, NULL),
	(200, '盈泰鞋业', '644301', 0, NULL, NULL, NULL),
	(201, 'CS-DEMO-海', '120020', 4, 1.0000, 1, 1),
	(202, 'wwq测试工厂1', '102700', 0, NULL, NULL, NULL),
	(203, '沃元精密机械', '700171', 0, NULL, NULL, NULL),
	(204, 'Eason', '100227', 0, NULL, NULL, NULL),
	(206, 'CSDEMO-孙金莉', '130000', 0, NULL, NULL, NULL),
	(208, 'CS-DEMO-周甫', '123060', 7, 1.0000, 1, 1),
	(210, 'yq1234', 'yq1234', 0, NULL, NULL, NULL),
	(211, 'CS-DEMO-曾', '126668', 3, 1.5000, 2, 1),
	(212, 'CS-DEMO-XX', '121357', 0, NULL, NULL, NULL),
	(213, 'CS-DEMO-WY', '122358', 0, NULL, NULL, NULL),
	(214, '亚大塑料-test', '121314', 6, 6.0000, 6, 6),
	(216, '022701-document', '022701', 0, NULL, NULL, NULL),
	(218, '022702document-true', '022702', 0, NULL, NULL, NULL),
	(219, '玉溪嘉和', '190228', 0, NULL, NULL, NULL),
	(220, 'CS-DEMO-CK1', '120CK1', 3, 3.0000, 3, 3),
	(221, '开山测试环境1', '120ks1', 16, 1.0000, 1, 1),
	(222, 'glq-201903', '201903', 0, NULL, NULL, NULL),
	(223, 'SALES-DEMO-ACE', '110030', 3, 3.0000, 3, 3),
	(224, '盐城银柱demo环境1', '120yz1', 10, 3.5122, 9, 1),
	(225, 'DEMO-ANNA', '120001', 1, 1.0000, 1, 1),
	(226, '盐城银柱DEMO环境2', '120yz2', 12, 3.4167, 9, 1);





